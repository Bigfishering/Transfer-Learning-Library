import os
import random
from common.vision.datasets.imagelist import ImageList
from common.vision.datasets._util import download


class Sun397(ImageList):
    CLASSES = ['a_abbey', 'a_airplane_cabin', 'a_airport_terminal', 'a_alley', 'a_amphitheater', 'a_amusement_arcade', 'a_amusement_park', 'a_anechoic_chamber', 'a_apartment_building_outdoor', 'a_apse_indoor', 'a_aquarium', 'a_aqueduct', 'a_arch', 'a_archive', 'a_arrival_gate_outdoor', 'a_art_gallery', 'a_art_school', 'a_art_studio', 'a_assembly_line', 'a_athletic_field_outdoor', 'a_atrium_public', 'a_attic', 'a_auditorium', 'a_auto_factory', 'b_badlands', 'b_badminton_court_indoor', 'b_baggage_claim', 'b_bakery_shop', 'b_balcony_exterior', 'b_balcony_interior', 'b_ball_pit', 'b_ballroom', 'b_bamboo_forest', 'b_banquet_hall', 'b_bar', 'b_barn', 'b_barndoor', 'b_baseball_field', 'b_basement', 'b_basilica', 'b_basketball_court_outdoor', 'b_bathroom', 'b_batters_box', 'b_bayou', 'b_bazaar_indoor', 'b_bazaar_outdoor', 'b_beach', 'b_beauty_salon', 'b_bedroom', 'b_berth', 'b_biology_laboratory', 'b_bistro_indoor', 'b_boardwalk', 'b_boat_deck', 'b_boathouse', 'b_bookstore', 'b_booth_indoor', 'b_botanical_garden', 'b_bow_window_indoor', 'b_bow_window_outdoor', 'b_bowling_alley', 'b_boxing_ring', 'b_brewery_indoor', 'b_bridge', 'b_building_facade', 'b_bullring', 'b_burial_chamber', 'b_bus_interior', 'b_butchers_shop', 'b_butte', 'c_cabin_outdoor', 'c_cafeteria', 'c_campsite', 'c_campus', 'c_canal_natural', 'c_canal_urban', 'c_candy_store', 'c_canyon', 'c_car_interior_backseat', 'c_car_interior_frontseat', 'c_carrousel', 'c_casino_indoor', 'c_castle', 'c_catacomb', 'c_cathedral_indoor', 'c_cathedral_outdoor', 'c_cavern_indoor', 'c_cemetery', 'c_chalet', 'c_cheese_factory', 'c_chemistry_lab', 'c_chicken_coop_indoor', 'c_chicken_coop_outdoor', 'c_childs_room', 'c_church_indoor', 'c_church_outdoor', 'c_classroom', 'c_clean_room', 'c_cliff', 'c_cloister_indoor', 'c_closet', 'c_clothing_store', 'c_coast', 'c_cockpit', 'c_coffee_shop', 'c_computer_room', 'c_conference_center', 'c_conference_room', 'c_construction_site', 'c_control_room', 'c_control_tower_outdoor', 'c_corn_field', 'c_corral', 'c_corridor', 'c_cottage_garden', 'c_courthouse', 'c_courtroom', 'c_courtyard', 'c_covered_bridge_exterior', 'c_creek', 'c_crevasse', 'c_crosswalk', 'c_cubicle_office', 'd_dam', 'd_delicatessen', 'd_dentists_office', 'd_desert_sand', 'd_desert_vegetation', 'd_diner_indoor', 'd_diner_outdoor', 'd_dinette_home', 'd_dinette_vehicle', 'd_dining_car', 'd_dining_room', 'd_discotheque', 'd_dock', 'd_doorway_outdoor', 'd_dorm_room', 'd_driveway', 'd_driving_range_outdoor', 'd_drugstore', 'e_electrical_substation', 'e_elevator_door', 'e_elevator_interior', 'e_elevator_shaft', 'e_engine_room', 'e_escalator_indoor', 'e_excavation', 'f_factory_indoor', 'f_fairway', 'f_fastfood_restaurant', 'f_field_cultivated', 'f_field_wild', 'f_fire_escape', 'f_fire_station', 'f_firing_range_indoor', 'f_fishpond', 'f_florist_shop_indoor', 'f_food_court', 'f_forest_broadleaf', 'f_forest_needleleaf', 'f_forest_path', 'f_forest_road', 'f_formal_garden', 'f_fountain', 'g_galley', 'g_game_room', 'g_garage_indoor', 'g_garbage_dump', 'g_gas_station', 'g_gazebo_exterior', 'g_general_store_indoor', 'g_general_store_outdoor', 'g_gift_shop', 'g_golf_course', 'g_greenhouse_indoor', 'g_greenhouse_outdoor', 'g_gymnasium_indoor', 'h_hangar_indoor', 'h_hangar_outdoor', 'h_harbor', 'h_hayfield', 'h_heliport', 'h_herb_garden', 'h_highway', 'h_hill', 'h_home_office', 'h_hospital', 'h_hospital_room', 'h_hot_spring', 'h_hot_tub_outdoor', 'h_hotel_outdoor', 'h_hotel_room', 'h_house', 'h_hunting_lodge_outdoor', 'i_ice_cream_parlor', 'i_ice_floe', 'i_ice_shelf', 'i_ice_skating_rink_indoor', 'i_ice_skating_rink_outdoor', 'i_iceberg', 'i_igloo', 'i_industrial_area', 'i_inn_outdoor', 'i_islet', 'j_jacuzzi_indoor', 'j_jail_indoor', 'j_jail_cell', 'j_jewelry_shop', 'k_kasbah', 'k_kennel_indoor', 'k_kennel_outdoor', 'k_kindergarden_classroom', 'k_kitchen', 'k_kitchenette', 'l_labyrinth_outdoor', 'l_lake_natural', 'l_landfill', 'l_landing_deck', 'l_laundromat', 'l_lecture_room', 'l_library_indoor', 'l_library_outdoor', 'l_lido_deck_outdoor', 'l_lift_bridge', 'l_lighthouse', 'l_limousine_interior', 'l_living_room', 'l_lobby', 'l_lock_chamber', 'l_locker_room', 'm_mansion', 'm_manufactured_home', 'm_market_indoor', 'm_market_outdoor', 'm_marsh', 'm_martial_arts_gym', 'm_mausoleum', 'm_medina', 'm_moat_water', 'm_monastery_outdoor', 'm_mosque_indoor', 'm_mosque_outdoor', 'm_motel', 'm_mountain', 'm_mountain_snowy', 'm_movie_theater_indoor', 'm_museum_indoor', 'm_music_store', 'm_music_studio', 'n_nuclear_power_plant_outdoor', 'n_nursery', 'o_oast_house', 'o_observatory_outdoor', 'o_ocean', 'o_office', 'o_office_building', 'o_oil_refinery_outdoor', 'o_oilrig', 'o_operating_room', 'o_orchard', 'o_outhouse_outdoor', 'p_pagoda', 'p_palace', 'p_pantry', 'p_park', 'p_parking_garage_indoor', 'p_parking_garage_outdoor', 'p_parking_lot', 'p_parlor', 'p_pasture', 'p_patio', 'p_pavilion', 'p_pharmacy', 'p_phone_booth', 'p_physics_laboratory', 'p_picnic_area', 'p_pilothouse_indoor', 'p_planetarium_outdoor', 'p_playground', 'p_playroom', 'p_plaza', 'p_podium_indoor', 'p_podium_outdoor', 'p_pond', 'p_poolroom_establishment', 'p_poolroom_home', 'p_power_plant_outdoor', 'p_promenade_deck', 'p_pub_indoor', 'p_pulpit', 'p_putting_green', 'r_racecourse', 'r_raceway', 'r_raft', 'r_railroad_track', 'r_rainforest', 'r_reception', 'r_recreation_room', 'r_residential_neighborhood', 'r_restaurant', 'r_restaurant_kitchen', 'r_restaurant_patio', 'r_rice_paddy', 'r_riding_arena', 'r_river', 'r_rock_arch', 'r_rope_bridge', 'r_ruin', 'r_runway', 's_sandbar', 's_sandbox', 's_sauna', 's_schoolhouse', 's_sea_cliff', 's_server_room', 's_shed', 's_shoe_shop', 's_shopfront', 's_shopping_mall_indoor', 's_shower', 's_skatepark', 's_ski_lodge', 's_ski_resort', 's_ski_slope', 's_sky', 's_skyscraper', 's_slum', 's_snowfield', 's_squash_court', 's_stable', 's_stadium_baseball', 's_stadium_football', 's_stage_indoor', 's_staircase', 's_street', 's_subway_interior', 's_subway_station_platform', 's_supermarket', 's_sushi_bar', 's_swamp', 's_swimming_pool_indoor', 's_swimming_pool_outdoor', 's_synagogue_indoor', 's_synagogue_outdoor', 't_television_studio', 't_temple_east_asia', 't_temple_south_asia', 't_tennis_court_indoor', 't_tennis_court_outdoor', 't_tent_outdoor', 't_theater_indoor_procenium', 't_theater_indoor_seats', 't_thriftshop', 't_throne_room', 't_ticket_booth', 't_toll_plaza', 't_topiary_garden', 't_tower', 't_toyshop', 't_track_outdoor', 't_train_railway', 't_train_station_platform', 't_tree_farm', 't_tree_house', 't_trench', 'u_underwater_coral_reef', 'u_utility_room', 'v_valley', 'v_van_interior', 'v_vegetable_garden', 'v_veranda', 'v_veterinarians_office', 'v_viaduct', 'v_videostore', 'v_village', 'v_vineyard', 'v_volcano', 'v_volleyball_court_indoor', 'v_volleyball_court_outdoor', 'w_waiting_room', 'w_warehouse_indoor', 'w_water_tower', 'w_waterfall_block', 'w_waterfall_fan', 'w_waterfall_plunge', 'w_watering_hole', 'w_wave', 'w_wet_bar', 'w_wheat_field', 'w_wind_farm', 'w_windmill', 'w_wine_cellar_barrel_storage', 'w_wine_cellar_bottle_storage', 'w_wrestling_ring_indoor', 'y_yard', 'y_youth_hostel']

    def __init__(self, root, split='train', **kwargs):
        download(root, "image_list", "image_list.zip", "https://cloud.tsinghua.edu.cn/f/247e4536023f431ca42e/?dl=1")
        super(Sun397, self).__init__(root, Sun397.CLASSES,
                                          os.path.join(root, "image_list", "{}.txt".format(split)), **kwargs)
        if split == 'train':
            random.seed(0)
            random.shuffle(self.samples)


